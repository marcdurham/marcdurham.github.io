---
layout: post
title: How To Use IL Disassembler (ILDASM)
date: '2014-09-18T10:31:00.001-07:00'
author: Marc Durham
tags: 
modified_time: '2014-09-19T08:12:56.239-07:00'
thumbnail: http://3.bp.blogspot.com/-J8gXSKnWtfg/VBsSEv3DDXI/AAAAAAAAKWE/rFUtItya3M8/s72-c/cmd_ildasm.png
blogger_id: tag:blogger.com,1999:blog-6813567.post-7313167382686362635
blogger_orig_url: https://blog.marcdurham.com/2014/09/how-to-use-il-disassembler-ildasm.html
---

<br>After you've built and deployed an ASP.NET or ASP.NET MVC web application to an IIS web server and then it throws an exception, but the exception doesn't have any line numbers referring to your source code, how do you find where the error is? <br><br>I had such an exception message, it was telling me that "a reference wasn't set to the instance of an object." &nbsp;But of course it wasn't telling me which 'reference' it was referring to, but it did tell me the module, the method name, and it had a little plus sign and a number (like this&nbsp;<b>+248)</b>&nbsp;after the method name.<br><br>This number is a 'memory (byte) offset.' &nbsp;It tells you which binary instruction, or which byte, inside the method is throwing an exception. &nbsp;In my case the method had several lambda expressions, so the source code line number, not just the name of the method, would be useful to me to fix the problem.<br><br>I searched online for a way to figure out precisely where in my code that the&nbsp;<b>+248</b>&nbsp;memory offset pointed to. &nbsp;I found out about a tool that was already included with Visual Studio 2010-2013 called <b>ILDASM</b>, or IL Disassember, and then I started figuring out how it worked and how to use it to find where my error was.<br><br>After an hour or so of playing with it I wondered why I had never used it before. &nbsp;So here are some 'quick and dirty' instructions on how to use ILDASM to find where an error is in your source code.<br><h4></h4><h4>Step 1: Open ILDASM</h4><div>The ILDASM tool comes with Visual Studio, you'll need to find it, most easily by opening the Developer Command Prompt. &nbsp;On my computer is was in the <b>C:\Program Files (x86)\Microsoft Visual Studio 12.0\ folder.&nbsp;</b></div><ol><li>From the Windows Start Menu, open a Visual Studio <b>Developer Command Prompt&nbsp;</b></li><li>Type &nbsp;<b>ildasm&nbsp;</b></li><li>Press <b>Enter</b>.</li></ol><a href="http://3.bp.blogspot.com/-J8gXSKnWtfg/VBsSEv3DDXI/AAAAAAAAKWE/rFUtItya3M8/s1600/cmd_ildasm.png" imageanchor="1" style="clear: left; display: inline !important; margin-bottom: 1em; margin-right: 1em; text-align: center;"><img border="0" src="http://3.bp.blogspot.com/-J8gXSKnWtfg/VBsSEv3DDXI/AAAAAAAAKWE/rFUtItya3M8/s1600/cmd_ildasm.png" height="76" width="320"></a><br><h4></h4><h4>Step 2: Find Your Project Folder &amp; The Compiled DLL&nbsp;</h4><div>Find the compiled module with the source code the that's throwing the exception. &nbsp;The original module that is throwing the exception should have been compiled from the same source code, obviously they need to be the same.</div><br><ol><li>Build your project in Visual Studio.</li><li>From ILDASM, click <b>File</b></li><li>Click <b>Open</b></li><li>Find your From my Visual Studio project folder. &nbsp;In the example my project folder is <b>C:\Code\MinistryTools1\MapViewer.</b></li><li>If your project built successfully the binary DLL files should be some where like the&nbsp;<b>bin\Debug</b> folder, sometimes it's different.</li><li>Navigate through the tree representation of the module and find the class and method that is throwing the exception. &nbsp;You should recognize the structure of the assembly, it should match the structure of your project.<br><div style="text-align: left;"><a href="http://2.bp.blogspot.com/-e08Kmz3FTzo/VBsQMc7k6dI/AAAAAAAAKVw/xIsb-iVqVUg/s1600/territory_divider.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em; text-align: center;"><img border="0" src="http://2.bp.blogspot.com/-e08Kmz3FTzo/VBsQMc7k6dI/AAAAAAAAKVw/xIsb-iVqVUg/s1600/territory_divider.png" height="320" width="213"></a></div></li></ol>Even though the exception was thrown from a non-debug compiled version of my project, the byte offsets should match as long as it was compiled from the same source code.<br><h4></h4><h4>Step 3: Calculate The Offset Hex Equivalent</h4>Calculate the byte offset from the exception message, that looks like +248, <br><div class="separator" style="clear: both; text-align: center;"></div><div class="separator" style="clear: both; text-align: center;"></div><br><ol><li>Open Calculator&nbsp;</li><li>Switch it to <b>Programmers Mode&nbsp;</b></li><li>Type the number in decimal</li><li>Click the <b>Hex</b> radio button to convert it to hexadecimal.<br><a href="http://4.bp.blogspot.com/-mpaCUHzCeYM/VBs6PLWniOI/AAAAAAAAKWg/-1yguWwRyvY/s1600/Calculator.png" imageanchor="1" style="clear: left; display: inline !important; margin-bottom: 1em; margin-right: 1em;"><img border="0" src="http://4.bp.blogspot.com/-mpaCUHzCeYM/VBs6PLWniOI/AAAAAAAAKWg/-1yguWwRyvY/s1600/Calculator.png" height="294" width="320"></a></li></ol><br><h4>Step 4: Find The Line Number From The Hex Offset</h4><div>You'll need to turn on the feature that shows you the source lines.</div><ol><li>In the menu, click&nbsp;<b>View</b></li><li>Select&nbsp;<b>Show source lines<br><div style="text-align: left;"><b></b><br><div class="separator" style="clear: both; display: inline !important; text-align: center;"><b><a href="http://3.bp.blogspot.com/-onpEfwhn3u8/VBsUZ_uHB9I/AAAAAAAAKWQ/iuQQQXvzKOk/s1600/Show%2Bsource%2Blines.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://3.bp.blogspot.com/-onpEfwhn3u8/VBsUZ_uHB9I/AAAAAAAAKWQ/iuQQQXvzKOk/s1600/Show%2Bsource%2Blines.png" height="320" width="200"></a></b></div><b></b></div></b></li><li>Double clicked on the tree node that matches the method name throwing the exception.</li><li>A disassembled version of your code should appear in a windows that looks like this:<br><div><a href="http://3.bp.blogspot.com/-3_Zfs8ZEsAY/VBsSCPMJroI/AAAAAAAAKV8/059qwuScLuk/s1600/CleanNonRomanCharacters.png" imageanchor="1" style="clear: left; display: inline !important; margin-bottom: 1em; margin-right: 1em; text-align: center;"><img border="0" src="http://3.bp.blogspot.com/-3_Zfs8ZEsAY/VBsSCPMJroI/AAAAAAAAKV8/059qwuScLuk/s1600/CleanNonRomanCharacters.png" height="200" width="320"></a></div></li><li>Find the hex numbered line that starts with <b>IL_, </b>example: IL_0013, this is the <u>hex&nbsp;memory offset</u>. &nbsp;</li><li>Look above the IL_ line for the source code line number. &nbsp;The source code lines are prefixed by two forward slashes and a six digit line number like this: <b>//000062</b></li></ol>Congratulations! You've identified the source code line number!<br><br>Now you can find the line in Visual Studio and try fixing it.<br><br>Also<br><br>I have also seen that sometimes there is a clause that starts with <b>.line 123,133 </b>which tells you what lines the following commands belong to. &nbsp;I haven't figured out why that's necessary yet.<br><div class="separator" style="clear: both; text-align: center;"><br></div>